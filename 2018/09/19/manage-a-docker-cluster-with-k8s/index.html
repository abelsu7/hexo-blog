<!DOCTYPE html>
<html>
<head><meta name="generator" content="Hexo 3.9.0">
    

    

    
<!-- Baidu Tongji -->
<script>var _hmt = _hmt || []</script>
<script async src="//hm.baidu.com/hm.js?c61262c25ca5d4ed66df331a31b5bf49"></script>
<!-- End Baidu Tongji -->




    <meta charset="utf-8">
    
    <meta name="google-site-verification" content="cc3c_UncRv21aEZwqejVxKpUMR7h9ldNUTeYjawUS-g">
    
    
    <meta name="baidu-site-verification" content="HnoV7q61W5">
    
    
    
    <title>ã€è¯‘ã€‘ä½¿ç”¨ Kubernetes ç®¡ç† Docker é›†ç¾¤ | Keep Coding | è‹æ˜“åŒ—</title>
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
    
    <meta name="theme-color" content="#3F51B5">
    
    
    <meta name="keywords" content="Docker,Kubernetes">
    <meta name="description" content="è¯‘è‡ª Manage a Docker Cluster with Kubernetes | Linode                                                                                               ä½¿ç”¨ Kubernetes ç®¡ç† Docker é›†ç¾¤">
<meta name="keywords" content="Docker,Kubernetes">
<meta property="og:type" content="article">
<meta property="og:title" content="ã€è¯‘ã€‘ä½¿ç”¨ Kubernetes ç®¡ç† Docker é›†ç¾¤">
<meta property="og:url" content="https://abelsu7.top/2018/09/19/manage-a-docker-cluster-with-k8s/index.html">
<meta property="og:site_name" content="Keep Coding">
<meta property="og:description" content="è¯‘è‡ª Manage a Docker Cluster with Kubernetes | Linode                                                                                               ä½¿ç”¨ Kubernetes ç®¡ç† Docker é›†ç¾¤">
<meta property="og:locale" content="zh-CN">
<meta property="og:image" content="https://abelsu7.top/2018/09/19/manage-a-docker-cluster-with-k8s/docker-cluster-kubernetes.jpg">
<meta property="og:image" content="https://abelsu7.top/2018/09/19/manage-a-docker-cluster-with-k8s/kubernetes-cluster.png">
<meta property="og:updated_time" content="2019-09-01T13:04:11.514Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="ã€è¯‘ã€‘ä½¿ç”¨ Kubernetes ç®¡ç† Docker é›†ç¾¤">
<meta name="twitter:description" content="è¯‘è‡ª Manage a Docker Cluster with Kubernetes | Linode                                                                                               ä½¿ç”¨ Kubernetes ç®¡ç† Docker é›†ç¾¤">
<meta name="twitter:image" content="https://abelsu7.top/2018/09/19/manage-a-docker-cluster-with-k8s/docker-cluster-kubernetes.jpg">
    
        <link rel="alternate" type="application/atom+xml" title="Keep Coding" href="/atom.xml">
    
    <link rel="shortcut icon" href="/img/favicon.ico">
    <link rel="stylesheet" href="/css/style.css?v=1.7.2">
    <link rel="stylesheet" href="/css/prism/prism-tomorrow-night.css?v=1.7.2">
    <script>window.lazyScripts=[]</script>

    <!-- custom head -->
    

</head>

<body>
    <div id="loading" class="active"></div>

    <aside id="menu" class="hide" >
  <div class="inner flex-row-vertical">
    <a href="javascript:;" class="header-icon waves-effect waves-circle waves-light" id="menu-off">
        <i class="icon icon-lg icon-list-ul"></i>
    </a>
    <div class="brand-wrap" style="background-image:url(/img/back_blue.png)">
      <div class="brand">
        <a href="/" class="avatar waves-effect waves-circle waves-light">
          <img src="/img/fong.jpg">
        </a>
        <hgroup class="introduce">
          <h5 class="nickname">Abel Su</h5>
          <a href="mailto:abelsu7@gmail.com" title="abelsu7@gmail.com" class="mail">abelsu7@gmail.com</a>
        </hgroup>
      </div>
    </div>
    <div class="scroll-wrap flex-col">
      <ul class="nav">
        
            <li class="waves-block waves-effect">
              <a href="/"  >
                <i class="icon icon-lg icon-home"></i>
                ä¸»é¡µ
              </a>
            </li>
        
            <li class="waves-block waves-effect">
              <a href="/archives/"  >
                <i class="icon icon-lg icon-archives"></i>
                å½’æ¡£
              </a>
            </li>
        
            <li class="waves-block waves-effect">
              <a href="/categories/"  >
                <i class="icon icon-lg icon-th-list"></i>
                åˆ†ç±»
              </a>
            </li>
        
            <li class="waves-block waves-effect">
              <a href="/tags/"  >
                <i class="icon icon-lg icon-tags"></i>
                æ ‡ç­¾
              </a>
            </li>
        
            <li class="waves-block waves-effect">
              <a href="https://notes.abelsu7.top"  >
                <i class="icon icon-lg icon-sticky-note"></i>
                ç¬”è®°
              </a>
            </li>
        
            <li class="waves-block waves-effect">
              <a href="https://github.com/abelsu7"  >
                <i class="icon icon-lg icon-github"></i>
                ä»£ç 
              </a>
            </li>
        
            <li class="waves-block waves-effect">
              <a href="/friends/"  >
                <i class="icon icon-lg icon-user"></i>
                å‹é“¾
              </a>
            </li>
        
            <li class="waves-block waves-effect">
              <a href="/bookmarks/"  >
                <i class="icon icon-lg icon-bookmark"></i>
                æ”¶è—
              </a>
            </li>
        
            <li class="waves-block waves-effect">
              <a href="/books/"  >
                <i class="icon icon-lg icon-book"></i>
                è¯»ä¹¦
              </a>
            </li>
        
            <li class="waves-block waves-effect">
              <a href="/movies/"  >
                <i class="icon icon-lg icon-film"></i>
                å½±è§†
              </a>
            </li>
        
            <li class="waves-block waves-effect">
              <a href="/games/"  >
                <i class="icon icon-lg icon-gamepad"></i>
                æ¸¸æˆ
              </a>
            </li>
        
            <li class="waves-block waves-effect">
              <a href="https://notes.abelsu7.top/#/links/wechat"  >
                <i class="icon icon-lg icon-wechat"></i>
                å¾®ä¿¡
              </a>
            </li>
        
            <li class="waves-block waves-effect">
              <a href="/2018/09/21/how-to-learn-coding/"  >
                <i class="icon icon-lg icon-code"></i>
                å­¦ä¹ 
              </a>
            </li>
        
            <li class="waves-block waves-effect">
              <a href="/wiki/"  >
                <i class="icon icon-lg icon-sort-alpha-asc"></i>
                é€ŸæŸ¥
              </a>
            </li>
        
            <li class="waves-block waves-effect">
              <a href="/about/"  >
                <i class="icon icon-lg icon-info-circle"></i>
                å…³äº
              </a>
            </li>
        
      </ul>
    </div>
  </div>
</aside>

    <main id="main">
        <header class="top-header" id="header">
    <div class="flex-row">
        <a href="javascript:;" class="header-icon waves-effect waves-circle waves-light on" id="menu-toggle">
          <i class="icon icon-lg icon-navicon"></i>
        </a>
        <div class="flex-col header-title ellipsis">ã€è¯‘ã€‘ä½¿ç”¨ Kubernetes ç®¡ç† Docker é›†ç¾¤</div>
        
        <div class="search-wrap" id="search-wrap">
            <a href="javascript:;" class="header-icon waves-effect waves-circle waves-light" id="back">
                <i class="icon icon-lg icon-chevron-left"></i>
            </a>
            <input type="text" id="key" class="search-input" autocomplete="off" placeholder="è¾“å…¥æ„Ÿå…´è¶£çš„å…³é”®å­—">
            <a href="javascript:;" class="header-icon waves-effect waves-circle waves-light" id="search">
                <i class="icon icon-lg icon-search"></i>
            </a>
        </div>
        
        
        <a href="javascript:;" class="header-icon waves-effect waves-circle waves-light" id="menuShare">
            <i class="icon icon-lg icon-share-alt"></i>
        </a>
        
    </div>
</header>
<header class="content-header post-header">

    <div class="container fade-scale">
        <h1 class="title">ã€è¯‘ã€‘ä½¿ç”¨ Kubernetes ç®¡ç† Docker é›†ç¾¤</h1>
        <h5 class="subtitle">
            
                <time datetime="2018-09-19T09:57:34.000Z" itemprop="datePublished" class="page-time">
  2018-09-19
</time>


	<ul class="article-category-list"><li class="article-category-list-item"><a class="article-category-list-link" href="/categories/Kubernetes/">Kubernetes</a></li></ul>

            
        </h5>
    </div>

    


</header>


<div class="container body-wrap">
    
    <aside class="post-widget">
        <nav class="post-toc-wrap post-toc-shrink" id="post-toc">
            <h4>TOC</h4>
            <ol class="post-toc"><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#ä»€ä¹ˆæ˜¯Kubernetesé›†ç¾¤ï¼Ÿ"><span class="post-toc-text">ä»€ä¹ˆæ˜¯Kubernetesé›†ç¾¤ï¼Ÿ</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#ç³»ç»Ÿè¦æ±‚"><span class="post-toc-text">ç³»ç»Ÿè¦æ±‚</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#å¼€å§‹å‰çš„å‡†å¤‡"><span class="post-toc-text">å¼€å§‹å‰çš„å‡†å¤‡</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#Kubernetes-Pods"><span class="post-toc-text">Kubernetes Pods</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#åˆ›å»ºéƒ¨ç½²"><span class="post-toc-text">åˆ›å»ºéƒ¨ç½²</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#æ‰©å±•éƒ¨ç½²"><span class="post-toc-text">æ‰©å±•éƒ¨ç½²</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#æ»šåŠ¨æ›´æ–°"><span class="post-toc-text">æ»šåŠ¨æ›´æ–°</span></a></li></ol></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#KubernetesæœåŠ¡"><span class="post-toc-text">KubernetesæœåŠ¡</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#Kuberneteså‘½åç©ºé—´"><span class="post-toc-text">Kuberneteså‘½åç©ºé—´</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#ä¸Šä¸‹æ–‡"><span class="post-toc-text">ä¸Šä¸‹æ–‡</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#æ ‡ç­¾"><span class="post-toc-text">æ ‡ç­¾</span></a></li></ol></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#KubernetesèŠ‚ç‚¹"><span class="post-toc-text">KubernetesèŠ‚ç‚¹</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#èŠ‚ç‚¹ç»´æŠ¤"><span class="post-toc-text">èŠ‚ç‚¹ç»´æŠ¤</span></a></li></ol></li></ol>
        </nav>
    </aside>


<article id="post-manage-a-docker-cluster-with-k8s"
  class="post-article article-type-post fade" itemprop="blogPost">

    <div class="post-card">
        <h1 class="post-card-title">ã€è¯‘ã€‘ä½¿ç”¨ Kubernetes ç®¡ç† Docker é›†ç¾¤</h1>
        <div class="post-meta">
            <time class="post-time" title="2018-09-19 17:57:34" datetime="2018-09-19T09:57:34.000Z"  itemprop="datePublished">2018-09-19</time>

            
	<ul class="article-category-list"><li class="article-category-list-item"><a class="article-category-list-link" href="/categories/Kubernetes/">Kubernetes</a></li></ul>



            
<span id="busuanzi_container_page_pv" title="æ–‡ç« æ€»é˜…è¯»é‡" style='display:none'>
    <i class="icon icon-eye icon-pr"></i><span id="busuanzi_value_page_pv"></span>
</span>


            
        </div>
        <div class="post-content" id="post-content" itemprop="postContent">
            <blockquote>
<p><strong><em>è¯‘è‡ª <a href="https://www.linode.com/docs/applications/containers/manage-a-docker-cluster-with-kubernetes/#kubernetes-namespaces" target="_blank" rel="noopener">Manage a Docker Cluster with Kubernetes | Linode</a></em></strong></p>
</blockquote>
<figure class="image-bubble">
                <div class="img-lightbox">
                    <div class="overlay"></div>
                    <img src="/2018/09/19/manage-a-docker-cluster-with-k8s/docker-cluster-kubernetes.jpg" alt="ä½¿ç”¨ Kubernetes ç®¡ç† Docker é›†ç¾¤" title>
                </div>
                <div class="image-caption">ä½¿ç”¨ Kubernetes ç®¡ç† Docker é›†ç¾¤</div>
            </figure>
<a id="more"></a>
<h2 id="ä»€ä¹ˆæ˜¯Kubernetesé›†ç¾¤ï¼Ÿ"><a href="#ä»€ä¹ˆæ˜¯Kubernetesé›†ç¾¤ï¼Ÿ" class="headerlink" title="ä»€ä¹ˆæ˜¯Kubernetesé›†ç¾¤ï¼Ÿ"></a>ä»€ä¹ˆæ˜¯Kubernetesé›†ç¾¤ï¼Ÿ</h2><p><a href="https://kubernetes.io/" target="_blank" rel="noopener">Kubernetes</a>æ˜¯ä¸€ä¸ªæ¥ç®¡ç†å®¹å™¨åŒ–åº”ç”¨ç¨‹åºçš„å¼€æºå¹³å°ã€‚å¦‚æœæ‚¨ä½¿ç”¨Dockerå°†åº”ç”¨éƒ¨ç½²åˆ°å¤šä¸ªæœåŠ¡å™¨èŠ‚ç‚¹ä¸Šï¼ŒKubernetesé›†ç¾¤å°±å¯ä»¥ç®¡ç†æ‚¨çš„æœåŠ¡å™¨å’Œåº”ç”¨ï¼ŒåŒ…æ‹¬æ‰©å±•ã€éƒ¨ç½²å’Œæ»šåŠ¨æ›´æ–°ç­‰æ“ä½œã€‚</p>
<p>Kubernetesé›†ç¾¤ç”±è‡³å°‘ä¸€ä¸ªä¸»èŠ‚ç‚¹å’Œå¤šä¸ªå·¥ä½œèŠ‚ç‚¹ç»„æˆã€‚ä¸»èŠ‚ç‚¹è¿è¡ŒAPIæœåŠ¡å™¨ã€è°ƒåº¦ç¨‹åºå’Œæ§åˆ¶å™¨ç®¡ç†å™¨ï¼Œå¹¶åœ¨é›†ç¾¤ä¸­åŠ¨æ€éƒ¨ç½²åº”ç”¨ç¨‹åºã€‚</p>
<h2 id="ç³»ç»Ÿè¦æ±‚"><a href="#ç³»ç»Ÿè¦æ±‚" class="headerlink" title="ç³»ç»Ÿè¦æ±‚"></a>ç³»ç»Ÿè¦æ±‚</h2><p>è¦å®Œæˆæœ¬æŒ‡å—çš„æ“ä½œï¼Œæ‚¨éœ€è¦ä¸‰å°è¿è¡ŒUbuntu 16.04 LTSçš„æœåŠ¡å™¨ï¼Œæ¯å°æœåŠ¡å™¨å†…å­˜éœ€åœ¨4GBä»¥ä¸Šã€‚</p>
<h2 id="å¼€å§‹å‰çš„å‡†å¤‡"><a href="#å¼€å§‹å‰çš„å‡†å¤‡" class="headerlink" title="å¼€å§‹å‰çš„å‡†å¤‡"></a>å¼€å§‹å‰çš„å‡†å¤‡</h2><p>æœ¬æ–‡éœ€è¦æ‚¨é¦–å…ˆå®Œæˆ<a href="https://linode.com/docs/applications/containers/how-to-deploy-nginx-on-a-kubernetes-cluster/" target="_blank" rel="noopener">å¦‚ä½•åœ¨Kubernetesé›†ç¾¤ä¸Šå®‰è£…ï¼Œé…ç½®å’Œéƒ¨ç½²NGINX</a>æŒ‡å—çš„ç›¸å…³æ“ä½œï¼Œå¹¶æŒ‰ç…§å…¶ä¸­çš„æ­¥éª¤é…ç½®ä¸€ä¸ªä¸»èŠ‚ç‚¹å’Œä¸¤ä¸ªå·¥ä½œèŠ‚ç‚¹ã€‚</p>
<p>è®¾ç½®ä¸‰å°æœåŠ¡å™¨ä¸»æœºåå¦‚ä¸‹ï¼š</p>
<ul>
<li>ä¸»èŠ‚ç‚¹ï¼š<code>kube-master</code></li>
<li>ç¬¬ä¸€ä¸ªå·¥ä½œèŠ‚ç‚¹ï¼š<code>kube-worker-1</code></li>
<li>ç¬¬äºŒä¸ªå·¥ä½œèŠ‚ç‚¹ï¼š<code>kube-worker-2</code></li>
</ul>
<p>é™¤éå¦æœ‰è¯´æ˜ï¼Œå¦åˆ™ä»¥ä¸‹çš„æ‰€æœ‰å‘½ä»¤éƒ½å°†åœ¨<code>kube-master</code>èŠ‚ç‚¹ä¸Šæ‰§è¡Œã€‚</p>
<h2 id="Kubernetes-Pods"><a href="#Kubernetes-Pods" class="headerlink" title="Kubernetes Pods"></a>Kubernetes Pods</h2><p>æ¯ä¸ªPodç”±ä¸€ä¸ªæˆ–å¤šä¸ªç´§å¯†è€¦åˆçš„å®¹å™¨ç»„æˆï¼Œè¿™äº›å®¹å™¨å…±äº«å­˜å‚¨å’Œç½‘ç»œç­‰èµ„æºã€‚Podä¸­çš„å®¹å™¨ä»¥Podä¸ºå•ä½å¯åŠ¨ã€åœæ­¢æˆ–å¤åˆ¶ã€‚</p>
<figure class="image-bubble">
                <div class="img-lightbox">
                    <div class="overlay"></div>
                    <img src="/2018/09/19/manage-a-docker-cluster-with-k8s/kubernetes-cluster.png" alt="Kubernetes Pods" title>
                </div>
                <div class="image-caption">Kubernetes Pods</div>
            </figure>
<h3 id="åˆ›å»ºéƒ¨ç½²"><a href="#åˆ›å»ºéƒ¨ç½²" class="headerlink" title="åˆ›å»ºéƒ¨ç½²"></a>åˆ›å»ºéƒ¨ç½²</h3><p><a href="https://kubernetes.io/docs/concepts/workloads/controllers/deployment/" target="_blank" rel="noopener">éƒ¨ç½²ï¼ˆDeploymentsï¼‰</a>æ˜¯å¯ä»¥ç®¡ç†Podåˆ›å»ºçš„é«˜çº§å¯¹è±¡ï¼Œå¹¶æ”¯æŒå£°æ˜æ€§æ‰©å±•å’Œæ»šåŠ¨å‡çº§ç­‰åŠŸèƒ½ã€‚</p>
<p>1.åœ¨æ–‡æœ¬ç¼–è¾‘å™¨ä¸­ï¼Œåˆ›å»º<code>nginx.yaml</code>é…ç½®æ–‡ä»¶å¹¶æ·»åŠ ä»¥ä¸‹å†…å®¹ã€‚</p>
<p><code>~/nginx.yaml</code>ï¼š</p>
<pre><code class="lang-yaml">apiVersion: apps/v1
kind: Deployment
metadata:
  name: nginx-server
  labels:
    app: nginx
spec:
  replicas: 1
  selector:
    matchLabels:
      app: nginx
  template:
    metadata:
      labels:
        app: nginx
    spec:
      containers:
      - name: nginx
        image: nginx:1.13-alpine
        ports:
        - containerPort: 80
</code></pre>
<p>è¯¥æ–‡ä»¶åŒ…å«äº†å®šä¹‰ä¸€ä¸ªéƒ¨ç½²æ‰€éœ€çš„æ‰€æœ‰å¿…è¦ä¿¡æ¯ï¼ŒåŒ…æ‹¬è¦ä½¿ç”¨çš„Dockeré•œåƒã€å‰¯æœ¬æ•°é‡ä»¥åŠå®¹å™¨ç«¯å£ã€‚è¦äº†è§£å…³äºé…ç½®éƒ¨ç½²çš„æ›´å¤šä¿¡æ¯ï¼Œè¯·å‚é˜…<a href="https://kubernetes.io/docs/concepts/workloads/controllers/deployment/#creating-a-deployment" target="_blank" rel="noopener">å®˜æ–¹æ–‡æ¡£</a>ã€‚</p>
<p>2.åˆ›å»ºæ‚¨çš„ç¬¬ä¸€ä¸ªéƒ¨ç½²ï¼š</p>
<pre><code class="lang-bash">kubectl create -f nginx.yaml --record
</code></pre>
<p>3.æŸ¥çœ‹éƒ¨ç½²åˆ—è¡¨ï¼š</p>
<pre class="command-line" data-user="root" data-host="kube-master" data-output="2-3">
<code class="language-bash">kubectl get deployments
NAME           DESIRED   CURRENT   UP-TO-DATE   AVAILABLE   AGE
nginx-server   1         1         1            1           13s</code>
</pre>

<p>4.æ£€æŸ¥PodçŠ¶æ€ï¼š</p>
<pre class="command-line" data-user="root" data-host="kube-master" data-output="2-3">
<code class="language-bash">kubectl get pods
NAME                           READY     STATUS    RESTARTS   AGE
nginx-server-b9bc6c6b5-d2gqv   1/1       Running   0          58</code>
</pre>

<p>5.è¦æŸ¥çœ‹éƒ¨ç½²çš„åˆ›å»ºèŠ‚ç‚¹ï¼Œè¯·æ·»åŠ <code>-o wide</code>å‚æ•°ï¼š</p>
<pre class="command-line" data-user="root" data-host="kube-master" data-output="2-3">
<code class="language-bash">kubectl get pods -o wide
NAME                           READY     STATUS    RESTARTS   AGE       IP                NODE
nginx-server-b9bc6c6b5-d2gqv   1/1       Running   0          1m        192.168.255.197   kube-worker-02</code>
</pre>

<h3 id="æ‰©å±•éƒ¨ç½²"><a href="#æ‰©å±•éƒ¨ç½²" class="headerlink" title="æ‰©å±•éƒ¨ç½²"></a>æ‰©å±•éƒ¨ç½²</h3><p>Kuberneteså¯ä»¥è½»æ¾æ‰©å±•éƒ¨ç½²ä»¥æ·»åŠ æˆ–åˆ é™¤å‰¯æœ¬ã€‚</p>
<p>1.å°†å‰¯æœ¬çš„æ•°é‡å¢åŠ åˆ°8ï¼š</p>
<pre><code class="lang-bash">kubectl scale deployment nginx-server --replicas=8
</code></pre>
<p>2.æ£€æŸ¥æ–°å‰¯æœ¬çš„å¯ç”¨æ€§ï¼š</p>
<pre class="command-line" data-user="root" data-host="kube-master" data-output="2-10">
<code class="language-bash">kubectl get pods -o wide
NAME                           READY     STATUS    RESTARTS   AGE       IP               NODE
nginx-server-b9bc6c6b5-4mdf6   1/1       Running   0          41s       192.168.180.10   kube-worker-1
nginx-server-b9bc6c6b5-8mvrd   1/1       Running   0          3m        192.168.180.9    kube-worker-1
nginx-server-b9bc6c6b5-b99pt   1/1       Running   0          40s       192.168.180.12   kube-worker-1
nginx-server-b9bc6c6b5-fjg2c   1/1       Running   0          40s       192.168.127.12   kube-worker-2
nginx-server-b9bc6c6b5-kgdq5   1/1       Running   0          41s       192.168.127.11   kube-worker-2
nginx-server-b9bc6c6b5-mhb7s   1/1       Running   0          40s       192.168.180.11   kube-worker-1
nginx-server-b9bc6c6b5-rlf9w   1/1       Running   0          41s       192.168.127.10   kube-worker-2
nginx-server-b9bc6c6b5-scwgj   1/1       Running   0          40s       192.168.127.13   kube-worker-2</code>
</pre>

<p>3.å¯ä»¥ä½¿ç”¨åŒæ ·çš„å‘½ä»¤å‡å°‘å‰¯æœ¬çš„æ•°é‡ï¼š</p>
<pre><code class="lang-bash">kubectl scale deployment nginx-server --replicas=3
</code></pre>
<h3 id="æ»šåŠ¨æ›´æ–°"><a href="#æ»šåŠ¨æ›´æ–°" class="headerlink" title="æ»šåŠ¨æ›´æ–°"></a>æ»šåŠ¨æ›´æ–°</h3><p>é€šè¿‡éƒ¨ç½²æ¥ç®¡ç†Podå…è®¸æ‚¨ä½¿ç”¨<strong>æ»šåŠ¨æ›´æ–°</strong>ï¼ˆRolling Upgradesï¼‰çš„åŠŸèƒ½ã€‚æ»šåŠ¨æ›´æ–°æ˜¯ä¸€ç§å…è®¸æ‚¨åœ¨ä¸åœæœºçš„æƒ…å†µä¸‹æ›´æ–°åº”ç”¨ç¨‹åºç‰ˆæœ¬çš„æœºåˆ¶ã€‚Kubernetesç¡®ä¿è‡³å°‘æœ‰25%çš„Podå¯éšæ—¶æä¾›æœåŠ¡ï¼Œå¹¶ä¼šåœ¨åˆ é™¤æ—§Podä¹‹å‰å…ˆåˆ›å»ºæ–°çš„Podã€‚</p>
<p>1.å°†å®¹å™¨çš„NGINXç‰ˆæœ¬ä» 1.13 å‡çº§åˆ° 1.13.8ï¼š</p>
<pre><code class="lang-bash">kubectl set image deployment/nginx-server nginx=nginx:1.13.8-alpine
</code></pre>
<p>ä¸æ‰©å±•è¿‡ç¨‹ç±»ä¼¼ï¼Œ<code>set</code>å‘½ä»¤ä½¿ç”¨å£°æ˜æ€§æ–¹æ³•ï¼šæ‚¨åªéœ€æŒ‡å®šæ‰€éœ€çš„ç›®æ ‡çŠ¶æ€ï¼Œæ§åˆ¶å™¨ä¼šç®¡ç†å®Œæˆè¯¥ç›®æ ‡æ‰€éœ€çš„æ‰€æœ‰ä»»åŠ¡ã€‚</p>
<p>2.æ£€æŸ¥æ›´æ–°çŠ¶æ€ï¼š</p>
<pre class="command-line" data-user="root" data-host="kube-master" data-output="2-10">
<code class="language-bash">kubectl rollout status deployment/nginx-server
Waiting for rollout to finish: 1 out of 3 new replicas have been updated...
Waiting for rollout to finish: 1 out of 3 new replicas have been updated...
Waiting for rollout to finish: 1 out of 3 new replicas have been updated...
Waiting for rollout to finish: 2 out of 3 new replicas have been updated...
Waiting for rollout to finish: 2 out of 3 new replicas have been updated...
Waiting for rollout to finish: 2 out of 3 new replicas have been updated...
Waiting for rollout to finish: 1 old replicas are pending termination...
Waiting for rollout to finish: 1 old replicas are pending termination...
deployment "nginx-server" successfully rolled out</code>
</pre>

<p>3.ä½ å¯ä»¥ä½¿ç”¨<code>describe</code>å‘½ä»¤æ‰‹åŠ¨æ£€æŸ¥åº”ç”¨ç¨‹åºç‰ˆæœ¬ï¼š</p>
<pre><code class="lang-bash">kubectl describe pod &lt;pod-name&gt;
</code></pre>
<p>4.å¦‚æœå‘ç”Ÿé”™è¯¯ï¼Œå›æ»šï¼ˆRolloutï¼‰å°†è¢«æŒ‚èµ·ï¼Œç³»ç»Ÿå°†å¼ºåˆ¶è¦æ±‚ç”¨æˆ·è¾“å…¥ <strong>CTRL + C</strong> ä»¥å–æ¶ˆæ›´æ–°ã€‚é€šè¿‡è®¾ç½®æ— æ•ˆçš„NGINXç‰ˆæœ¬æ¥æµ‹è¯•ï¼š</p>
<pre><code class="lang-bash">kubectl set image deployment/nginx-server nginx=nginx:1.18.
</code></pre>
<p>5.æŸ¥çœ‹å½“å‰PodçŠ¶æ€ï¼š</p>
<pre class="command-line" data-user="root" data-host="kube-master" data-output="2-6">
<code class="language-bash">kubectl get pods -o wide
NAME                            READY     STATUS             RESTARTS   AGE       IP               NODE
nginx-server-76976d4555-7nv6z   1/1       Running            0          3m        192.168.127.15   kube-worker-2
nginx-server-76976d4555-wg785   1/1       Running            0          3m        192.168.180.13   kube-worker-1
nginx-server-76976d4555-ws4vf   1/1       Running            0          3m        192.168.127.14   kube-worker-2
nginx-server-7ddd985dd6-mpn9h   0/1       ImagePullBackOff   0          2m        192.168.180.16   kube-worker-1</code>
</pre>

<p>å¯ä»¥çœ‹åˆ°åä¸º<code>nginx-server-7ddd985dd6-mpn9h</code>çš„Podæ­£åœ¨è¯•å›¾å°†NGINXæ›´æ–°åˆ°ä¸€ä¸ªä¸å­˜åœ¨çš„ç‰ˆæœ¬ã€‚</p>
<p>6.æ£€æŸ¥æ­¤Podä»¥è·å–è¯¥é”™è¯¯çš„æ›´å¤šè¯¦ç»†ä¿¡æ¯ï¼š</p>
<pre><code class="lang-bash">kubectl describe pod nginx-server-7ddd985dd6-mpn9h
</code></pre>
<p>7.ç”±äºåœ¨åˆ›å»ºéƒ¨ç½²æ—¶ä½¿ç”¨äº†<code>--record</code>å‚æ•°ï¼Œæ‚¨å¯ä»¥é€šè¿‡ä»¥ä¸‹å‘½ä»¤æ£€ç´¢å®Œæ•´çš„å†å²è®°å½•ï¼š</p>
<pre class="command-line" data-user="root" data-host="kube-master" data-output="2-5">
<code class="language-bash">kubectl rollout history deployment/nginx-server
REVISION  CHANGE-CAUSE
1         kubectl scale deployment nginx-server --replicas=3
2         kubectl set image deployment/nginx-server nginx=nginx:1.13.8-alpine
3         kubectl set image deployment/nginx-server nginx=nginx:1.18</code>
</pre>

<p>8.æ‚¨å¯ä»¥ä½¿ç”¨<code>undo</code>å‘½ä»¤å›æ»šåˆ°ä¹‹å‰çš„å·¥ä½œç‰ˆæœ¬ï¼š</p>
<pre><code class="lang-bash">kubectl rollout undo deployment/nginx-server
</code></pre>
<p>9.è¦å›æ»šåˆ°ç‰¹å®šçš„ç‰ˆæœ¬ï¼Œè¯·ä½¿ç”¨<code>--to-revision</code>é€‰é¡¹ä»¥æŒ‡å®šè¦å›æ»šçš„ç›®æ ‡ç‰ˆæœ¬ï¼š</p>
<pre><code class="lang-bash">kubectl rollout undo deployment/nginx-server --to-revision=1
</code></pre>
<h2 id="KubernetesæœåŠ¡"><a href="#KubernetesæœåŠ¡" class="headerlink" title="KubernetesæœåŠ¡"></a>KubernetesæœåŠ¡</h2><p>æ‚¨ç°åœ¨å·²ç»æœ‰äº†ä¸€ä¸ªè¿è¡Œä¸‰ä¸ªPodçš„éƒ¨ç½²ï¼Œæ¯ä¸ªPodéƒ½è¿è¡Œäº†ä¸€ä¸ªNGINXåº”ç”¨ã€‚è¦å°†Podå‘å¸ƒåˆ°äº’è”ç½‘ï¼Œæ‚¨éœ€è¦åˆ›å»ºä¸€ä¸ª <strong>æœåŠ¡</strong>ã€‚åœ¨Kubernetesä¸­ï¼ŒæœåŠ¡æ˜¯ä¸€ç§æŠ½è±¡ï¼Œå…è®¸éšæ—¶è®¿é—®Podã€‚æœåŠ¡ä¼šè‡ªåŠ¨å¤„ç†IPæ›´æ”¹ï¼Œæ›´æ–°ä»¥åŠæ‰©å±•ï¼Œå› æ­¤åœ¨å¯ç”¨è¯¥æœåŠ¡åï¼Œåªè¦è¿è¡Œçš„Podä¿æŒæ´»åŠ¨çŠ¶æ€ï¼Œå°±å¯é€šè¿‡äº’è”ç½‘è®¿é—®æ‚¨çš„åº”ç”¨ç¨‹åºã€‚</p>
<p>1.é…ç½®ä¸€ä¸ªæµ‹è¯•æœåŠ¡ã€‚</p>
<p><code>~/nginx-service.yaml</code>ï¼š</p>
<pre><code class="lang-yaml">apiVersion: v1
kind: Service
metadata:
  name: nginx-service
  labels:
    run: nginx
spec:
  type: NodePort
  ports:
  - port: 80
    targetPort: 80
    protocol: TCP
    name: http
  selector:
    app: nginx
</code></pre>
<p>2.åˆ›å»ºæœåŠ¡ï¼š</p>
<pre><code class="lang-bash">kubectl create -f nginx-service.yaml
</code></pre>
<p>3.æ£€æŸ¥æ–°æœåŠ¡çš„çŠ¶æ€ï¼š</p>
<pre class="command-line" data-user="root" data-host="kube-master" data-output="2-4">
<code class="language-bash">kubectl get services
NAME            TYPE        CLUSTER-IP    EXTERNAL-IP   PORT(S)        AGE
kubernetes      ClusterIP   10.96.0.1     <none>        443/TCP        2d
nginx-service   NodePort    10.97.41.31   <none>        80:31738/TCP   38m</none></none></code>
</pre>

<p>æœåŠ¡æ­£åœ¨è¿è¡Œå¹¶æ¥å—<code>31738</code>ç«¯å£ä¸Šçš„è¿æ¥ã€‚</p>
<p>4.æµ‹è¯•æœåŠ¡ï¼š</p>
<pre><code class="lang-bash">curl &lt;MASTER_LINODE_PUBLIC_IP_ADDRESS&gt;:&lt;PORT(S)&gt;
</code></pre>
<p>5.ä½¿ç”¨<code>describe</code>å‘½ä»¤æŸ¥çœ‹æ­¤æœåŠ¡çš„å…¶ä»–ä¿¡æ¯ï¼š</p>
<pre class="command-line" data-user="root" data-host="kube-master" data-output="2-15">
<code class="language-bash">kubectl describe service nginx-service
Name:                     nginx-service
Namespace:                default
Labels:                   run=nginx
Annotations:              <none> 
Selector:                 app=nginx
Type:                     NodePort
IP:                       10.97.41.31
Port:                     http  80/TCP
TargetPort:               80/TCP
NodePort:                 http  31738/TCP
Endpoints:                192.168.127.14:80,192.168.127.15:80,192.168.180.13:80
Session Affinity:         None
External Traffic Policy:  Cluster
Events:                   <none> </none></none></code>
</pre>

<h2 id="Kuberneteså‘½åç©ºé—´"><a href="#Kuberneteså‘½åç©ºé—´" class="headerlink" title="Kuberneteså‘½åç©ºé—´"></a>Kuberneteså‘½åç©ºé—´</h2><p>å‘½åç©ºé—´æ˜¯æ˜¯ä¸€ä¸ªé€»è¾‘ç¯å¢ƒï¼Œå¯ä»¥çµæ´»çš„åœ¨å¤šä¸ªå›¢é˜Ÿæˆ–ç”¨æˆ·ä¹‹é—´åˆ’åˆ†é›†ç¾¤èµ„æºã€‚</p>
<p>1.æŸ¥çœ‹å¯ç”¨çš„å‘½åç©ºé—´ï¼š</p>
<pre class="command-line" data-user="root" data-host="kube-master" data-output="2-4">
<code class="language-bash">kubectl get namespaces
default       Active        7h
kube-public   Active        7h
kube-system   Active        7h</code>
</pre>

<p>é¡¾åæ€ä¹‰ï¼Œå¦‚æœæœªæŒ‡å®šå…¶ä»–çš„å‘½åç©ºé—´ï¼Œåˆ™æ‚¨çš„éƒ¨ç½²å°†ä¼šæ”¾ç½®åœ¨<code>default</code>å‘½åç©ºé—´ä¸‹ã€‚<code>kube-system</code>ä¸ºKubernetesåˆ›å»ºçš„å¯¹è±¡ä¿ç•™ï¼Œè€Œ<code>kube-public</code>åˆ™å¯¹æ‰€æœ‰ç”¨æˆ·å¯ç”¨ã€‚å‘½åç©ºé—´å¯ä»¥é€šè¿‡<code>.json</code>æ–‡ä»¶åˆ›å»ºï¼Œä¹Ÿå¯ä»¥ç›´æ¥åœ¨å‘½ä»¤è¡Œåˆ›å»ºã€‚</p>
<p>2.ä¸º <strong>development</strong> ç¯å¢ƒæ–°å»ºåä¸º<code>dev-namespace.json</code>çš„æ–‡ä»¶ã€‚</p>
<p><code>~/home/dev-namespace.json</code>ï¼š</p>
<pre><code class="lang-json">{
  &quot;kind&quot;: &quot;Namespace&quot;,
  &quot;apiVersion&quot;: &quot;v1&quot;,
  &quot;metadata&quot;: {
    &quot;name&quot;: &quot;development&quot;,
    &quot;labels&quot;: {
      &quot;name&quot;: &quot;development&quot;
    }
  }
}
</code></pre>
<p>3.åœ¨é›†ç¾¤ä¸­åˆ›å»ºå‘½åç©ºé—´ï¼š</p>
<pre><code class="lang-bash">kubectl create -f dev-namespace.json
</code></pre>
<p>4.å†æ¬¡æŸ¥çœ‹å‘½åç©ºé—´ï¼š</p>
<pre><code class="lang-bash">kubectl get namespaces
</code></pre>
<h3 id="ä¸Šä¸‹æ–‡"><a href="#ä¸Šä¸‹æ–‡" class="headerlink" title="ä¸Šä¸‹æ–‡"></a>ä¸Šä¸‹æ–‡</h3><p>è¦ä½¿ç”¨å‘½åç©ºé—´ï¼Œæ‚¨éœ€è¦å®šä¹‰ä½¿ç”¨å‘½åç©ºé—´çš„ <strong>ä¸Šä¸‹æ–‡</strong>ï¼ˆContextï¼‰ã€‚Kubernetesä¸Šä¸‹æ–‡ä¿å­˜åœ¨<code>kubectl</code>é…ç½®æ–‡ä»¶ä¸­ã€‚</p>
<p>1.æŸ¥çœ‹å½“å‰çš„é…ç½®ï¼š</p>
<pre><code class="lang-bash">kubectl config view
</code></pre>
<p>2.æ£€æŸ¥æ‚¨å½“å‰æ­£åœ¨ä½¿ç”¨çš„ä¸Šä¸‹æ–‡ï¼š</p>
<pre><code class="lang-bash">kubectl config current-context
</code></pre>
<p>3.ä½¿ç”¨ä»¥ä¸‹å‘½ä»¤æ·»åŠ <code>dev</code>ä¸Šä¸‹æ–‡ï¼š</p>
<pre><code class="lang-bash">kubectl config set-context dev --namespace=development \
--cluster=kubernetes \
--user=kubernetes-admin
</code></pre>
<p>4.åˆ‡æ¢è‡³<code>dev</code>ä¸Šä¸‹æ–‡/å‘½åç©ºé—´ï¼š</p>
<pre><code class="lang-bash">kubectl config use-context dev
</code></pre>
<p>5.éªŒè¯æ›´æ”¹æ˜¯å¦ç”Ÿæ•ˆï¼š</p>
<pre><code class="lang-bash">kubectl config current-context
</code></pre>
<p>6.æŸ¥çœ‹æ–°çš„é…ç½®ï¼š</p>
<pre><code class="lang-bash">kubectl config view
</code></pre>
<p>7.å‘½åç©ºé—´ä¸­çš„Podå¯¹å…¶ä»–å‘½åç©ºé—´ä¸å¯è§ã€‚åˆ—å‡ºæ‚¨çš„Podæ¥æ£€æŸ¥è¯¥ç‰¹æ€§ï¼š</p>
<pre><code class="lang-bash">kubectl get pods
</code></pre>
<p>ç³»ç»Ÿæç¤ºâ€œNo resources foundâ€ï¼Œæ˜¯å› ä¸ºæ‚¨æœªåœ¨æ­¤å‘½åç©ºé—´ä¸­åˆ›å»ºPodæˆ–éƒ¨ç½²ï¼Œä¸è¿‡æ‚¨ä»ç„¶å¯ä»¥æ·»åŠ <code>--all-namespaces</code>å‚æ•°æ¥æŸ¥çœ‹è¿™äº›å¯¹è±¡ï¼š</p>
<pre><code class="lang-bash">kubectl get services --all-namespaces
</code></pre>
<h3 id="æ ‡ç­¾"><a href="#æ ‡ç­¾" class="headerlink" title="æ ‡ç­¾"></a>æ ‡ç­¾</h3><p>Kubernetesä¸­çš„ä»»ä½•å¯¹è±¡éƒ½å¯ä»¥æ·»åŠ æ ‡ç­¾ã€‚æ ‡ç­¾æ˜¯ä¸€ç»„é”®å€¼å¯¹ï¼Œå¯ä»¥å¸®åŠ©ç”¨æˆ·åŸºäºå„ç§ç‰¹å¾æ›´åŠ è½»æ¾çš„ç»„ç»‡ã€è¿‡æ»¤å¹¶é€‰æ‹©å¯¹è±¡ã€‚</p>
<p>1.åœ¨æ­¤å‘½åç©ºé—´ä¸­åˆ›å»ºä¸€ä¸ªæµ‹è¯•éƒ¨ç½²ï¼Œæ­¤éƒ¨ç½²å°†åŒ…å«<code>nginx</code>æ ‡ç­¾ã€‚</p>
<p><code>~/my-app.yaml</code>ï¼š</p>
<pre><code class="lang-yaml">apiVersion: apps/v1
kind: Deployment
metadata:
  name: my-app
  labels:
    app: my-app
spec:
  replicas: 4
  selector:
    matchLabels:
      app: nginx
  template:
    metadata:
      labels:
        app: nginx
    spec:
      containers:
      - name: nginx
        image: nginx:1.12-alpine
        ports:
        - containerPort: 80
</code></pre>
<p>2.åˆ›å»ºéƒ¨ç½²ï¼š</p>
<pre><code class="lang-bash">kubectl create -f my-app.yaml --record
</code></pre>
<p>3.å¦‚æœæ‚¨åªéœ€åœ¨é›†ç¾¤ä¸­æŸ¥æ‰¾ç‰¹å®šçš„Podï¼Œè€Œä¸æ˜¯åˆ—å‡ºæ‰€æœ‰Podï¼Œé‚£ä¹ˆåœ¨å‘½ä»¤ä¸­æ·»åŠ <code>-l</code>é€‰é¡¹ä»¥æŒ‰æ ‡ç­¾æœç´¢é€šå¸¸æ›´æœ‰æ•ˆç‡ï¼š</p>
<pre><code class="lang-bash">kubectl get pods --all-namespaces -l app=nginx
</code></pre>
<p>è¿™é‡Œä»…åˆ—å‡ºäº†<code>default</code>å’Œ<code>development</code>å‘½åç©ºé—´ä¸­çš„Podï¼Œå› ä¸ºå®ƒä»¬çš„å®šä¹‰ä¸­åŒ…å«<code>nginx</code>æ ‡ç­¾ã€‚</p>
<h2 id="KubernetesèŠ‚ç‚¹"><a href="#KubernetesèŠ‚ç‚¹" class="headerlink" title="KubernetesèŠ‚ç‚¹"></a>KubernetesèŠ‚ç‚¹</h2><p>KubernetesèŠ‚ç‚¹å¯ä»¥æ˜¯ç‰©ç†æœºæˆ–è™šæ‹Ÿæœºã€‚å¯ä»¥å°†èŠ‚ç‚¹è§†ä¸ºKubernetesæŠ½è±¡æ¨¡å‹ä¸­çš„æœ€é«˜çº§åˆ«ã€‚</p>
<p>1.åˆ—å‡ºæ‚¨å½“å‰çš„èŠ‚ç‚¹ï¼š</p>
<pre class="command-line" data-user="root" data-host="kube-master" data-output="2-5">
<code class="language-bash">kubectl get nodes
NAME             STATUS    ROLES     AGE       VERSION
kube-master      Ready     master    21h       v1.9.2
kube-worker-1    Ready     <none>    19h       v1.9.2
kube-worker-2    Ready     <none>    17h       v1.9.2</none></none></code>
</pre>

<p>2.è¦æŸ¥çœ‹æ›´å¤šä¿¡æ¯ï¼Œæ·»åŠ <code>-o</code>å‚æ•°ï¼š</p>
<pre><code class="lang-bash">kubectl get nodes -o wide
</code></pre>
<p>3.æ˜¾ç¤ºçš„ä¿¡æ¯å¤§éƒ¨åˆ†æ˜¯è‡ªè§£é‡Šçš„ï¼Œå¯¹äºæ£€æŸ¥å…¨éƒ¨èŠ‚ç‚¹æ˜¯å¦å‡†å¤‡å°±ç»ªè€Œè¨€éå¸¸æœ‰ç”¨ã€‚æ‚¨å¯ä»¥ä½¿ç”¨<code>describe</code>å‘½ä»¤ä»¥è·å–ç‰¹å®šèŠ‚ç‚¹çš„è¯¦ç»†ä¿¡æ¯ï¼š</p>
<pre><code class="lang-bash">kubectl describe node kube-worker-1
</code></pre>
<h3 id="èŠ‚ç‚¹ç»´æŠ¤"><a href="#èŠ‚ç‚¹ç»´æŠ¤" class="headerlink" title="èŠ‚ç‚¹ç»´æŠ¤"></a>èŠ‚ç‚¹ç»´æŠ¤</h3><p>Kubernetesæä¾›äº†ä¸€ç§éå¸¸ç›´æ¥çš„åŠæ³•ä½¿èŠ‚ç‚¹å®‰å…¨ç¦»çº¿ã€‚</p>
<p>1.è¿”å›æ‚¨æ­£åœ¨è¿è¡ŒNGINXæœåŠ¡çš„é»˜è®¤å‘½åç©ºé—´ï¼š</p>
<pre><code class="lang-bash">kubectl config use-context kubernetes-admin@kubernetes
</code></pre>
<p>2.æ£€æŸ¥æ‚¨çš„Podï¼š</p>
<pre><code class="lang-bash">kubectl get pods -o wide
</code></pre>
<p>3.åœ¨<code>kube-worker-2</code>èŠ‚ç‚¹ä¸Šç¦æ­¢æ–°Podçš„åˆ›å»ºï¼š</p>
<pre><code class="lang-bash">kubectl cordon kube-worker-2
</code></pre>
<p>4.æ£€æŸ¥æ‚¨çš„èŠ‚ç‚¹çŠ¶æ€ï¼š</p>
<pre class="command-line" data-user="root" data-host="kube-master" data-output="2-5">
<code class="language-bash">kubectl get nodes
NAME             STATUS                     ROLES     AGE       VERSION
kube-master      Ready                      master    4h        v1.9.2
kube-worker-1    Ready                      <none>    4h        v1.9.2
kube-worker-2    Ready,SchedulingDisabled   <none>    4h        v1.9.2</none></none></code>
</pre>

<p>5.è¦æµ‹è¯•Kubernetesæ§åˆ¶å™¨å’Œè°ƒåº¦ç¨‹åºï¼Œè¯·æ‰©å±•æ‚¨çš„éƒ¨ç½²ï¼š</p>
<pre><code class="lang-bash">kubectl scale deployment nginx-server --replicas=10
</code></pre>
<p>6.å†æ¬¡æŸ¥çœ‹æ‚¨çš„Podï¼š</p>
<pre class="command-line" data-user="root" data-host="kube-master" data-output="2-12">
<code class="language-bash">kubectl get pods -o wide
NAME                           READY     STATUS    RESTARTS   AGE       IP                NODE
nginx-server-b9bc6c6b5-2pnbk   1/1       Running   0          11s       192.168.188.146   kube-worker-1
nginx-server-b9bc6c6b5-4cls5   1/1       Running   0          11s       192.168.188.148   kube-worker-1
nginx-server-b9bc6c6b5-7nw5m   1/1       Running   0          3d        192.168.255.220   kube-worker-2
nginx-server-b9bc6c6b5-7s7w5   1/1       Running   0          44s       192.168.188.143   kube-worker-1
nginx-server-b9bc6c6b5-88dvp   1/1       Running   0          11s       192.168.188.145   kube-worker-1
nginx-server-b9bc6c6b5-95jgr   1/1       Running   0          3d        192.168.255.221   kube-worker-2
nginx-server-b9bc6c6b5-md4qd   1/1       Running   0          3d        192.168.188.139   kube-worker-1
nginx-server-b9bc6c6b5-r5krq   1/1       Running   0          11s       192.168.188.144   kube-worker-1
nginx-server-b9bc6c6b5-r5nd6   1/1       Running   0          44s       192.168.188.142   kube-worker-1
nginx-server-b9bc6c6b5-ztgmr   1/1       Running   0          11s       192.168.188.147   kube-worker-1</code>
</pre>

<p>ç°åœ¨æ€»å…±æœ‰10ä¸ªPodï¼Œä½†æ–°Podåªåœ¨ç¬¬ä¸€ä¸ªèŠ‚ç‚¹ä¸­åˆ›å»ºã€‚</p>
<p>7.é€šçŸ¥<code>kube-worker-2</code>èŠ‚ç‚¹åœæ­¢å…¶è¿è¡Œçš„Podï¼š</p>
<pre class="command-line" data-user="root" data-host="kube-master" data-output="2-8">
<code class="language-bash">kubectl drain kube-worker-2 --ignore-daemonsets
node "kube-worker-2" already cordoned
WARNING: Ignoring DaemonSet-managed pods: calico-node-9mgc6, kube-proxy-2v8rw
pod "my-app-68845b9f68-wcqsb" evicted
pod "nginx-server-b9bc6c6b5-7nw5m" evicted
pod "nginx-server-b9bc6c6b5-95jgr" evicted
pod "my-app-68845b9f68-n5kpt" evicted
node "kube-worker-2" drained</code>
</pre>

<p>8.æ£€æŸ¥ä¸Šè¿°å‘½ä»¤å¯¹æ‚¨Podäº§ç”Ÿçš„æ•ˆæœï¼š</p>
<pre class="command-line" data-user="root" data-host="kube-master" data-output="2-12">
<code class="language-bash">kubectl get pods -o wide
NAME                           READY     STATUS    RESTARTS   AGE       IP                NODE
nginx-server-b9bc6c6b5-2pnbk   1/1       Running   0          9m        192.168.188.146   kube-worker-1
nginx-server-b9bc6c6b5-4cls5   1/1       Running   0          9m        192.168.188.148   kube-worker-1
nginx-server-b9bc6c6b5-6zbv6   1/1       Running   0          3m        192.168.188.152   kube-worker-1
nginx-server-b9bc6c6b5-7s7w5   1/1       Running   0          9m        192.168.188.143   kube-worker-1
nginx-server-b9bc6c6b5-88dvp   1/1       Running   0          9m        192.168.188.145   kube-worker-1
nginx-server-b9bc6c6b5-c2c5c   1/1       Running   0          3m        192.168.188.150   kube-worker-1
nginx-server-b9bc6c6b5-md4qd   1/1       Running   0          3d        192.168.188.139   kube-worker-1
nginx-server-b9bc6c6b5-r5krq   1/1       Running   0          9m        192.168.188.144   kube-worker-1
nginx-server-b9bc6c6b5-r5nd6   1/1       Running   0          9m        192.168.188.142   kube-worker-1
nginx-server-b9bc6c6b5-ztgmr   1/1       Running   0          9m        192.168.188.147   kube-worker-1</code>
</pre>

<p>9.æ‚¨ç°åœ¨å·²ç»å¯ä»¥åœ¨ä¸ä¸­æ–­æœåŠ¡çš„æƒ…å†µä¸‹å®‰å…¨å…³é—­<code>kube-worker-2</code>èŠ‚ç‚¹ã€‚</p>
<p>10.å®Œæˆç»´æŠ¤åï¼Œé€šçŸ¥æ§åˆ¶å™¨æ­¤èŠ‚ç‚¹å¯ä»¥å†æ¬¡è¿›è¡Œè°ƒåº¦ï¼š</p>
<pre><code class="lang-bash">kubectl uncordon kube-worker-2
</code></pre>
<blockquote>
<p><strong>å‚è€ƒèµ„æ–™</strong></p>
<ol>
<li><a href="https://www.linode.com/docs/applications/containers/manage-a-docker-cluster-with-kubernetes/#kubernetes-namespaces" target="_blank" rel="noopener">Manage a Docker Cluster with Kubernetes | Linode</a></li>
<li><a href="https://cloud.tencent.com/developer/article/1344017" target="_blank" rel="noopener">ä½¿ç”¨Kubernetesç®¡ç†Dockeré›†ç¾¤ | è…¾è®¯äº‘+ç¤¾åŒº</a></li>
<li><a href="https://legacy.gitbook.com/book/rootsongjc/kubernetes-handbook/details" target="_blank" rel="noopener">Kubernetes Handbook | Gitbook</a></li>
<li><a href="https://kubernetes.io/docs/home" target="_blank" rel="noopener">Kuberneteså®˜æ–¹æ–‡æ¡£</a></li>
<li><a href="https://docs.projectcalico.org/v2.0/getting-started/kubernetes/" target="_blank" rel="noopener">Calicoå®˜æ–¹æ–‡æ¡£</a></li>
</ol>
</blockquote>
<div><strong>ğŸš©æ¨èé˜…è¯»</strong>ï¼ˆç”±<a href="https://github.com/huiwang/hexo-recommended-posts">hexoæ–‡ç« æ¨èæ’ä»¶</a>é©±åŠ¨ï¼‰<ul><li><a href="https://abelsu7.top/2019/09/25/micro-service-orchestration-and-container-schedule/">å¾®æœåŠ¡ç¼–æ’ä¸å®¹å™¨è°ƒåº¦</a></li><li><a href="https://abelsu7.top/2019/09/18/micro-service-notes/">å¾®æœåŠ¡å­¦ä¹ èµ„æ–™æ±‡æ€»</a></li><li><a href="https://abelsu7.top/2019/03/19/recent-review/">è¿‘æœŸå¤ä¹ åˆé›†</a></li><li><a href="https://abelsu7.top/2019/03/18/k8s-quick-guides/">Kubernetes å®è·µç®€æ˜æŒ‡å—</a></li><li><a href="http://localhost:4000/posts/4159187524/">WSLä¸‹Dockerä½¿ç”¨è¸©å‘å°è®°</a></li><li><a href="http://localhost:4000/posts/3995512051/">åŸºäºDockeræ„å»º.NETæŒç»­é›†æˆç¯å¢ƒ</a></li></ul></div>
        </div>

        <blockquote class="post-copyright">
    
    <div class="content">
        
<span class="post-time">
    æœ€åæ›´æ–°æ—¶é—´ï¼š<time datetime="2019-09-01T13:04:11.514Z" itemprop="dateUpdated">2019-09-01 21:04:11</time>
</span><br>


        
        æ–‡ç« å‘å¸ƒåœ°å€ï¼š<a href="/2018/09/19/manage-a-docker-cluster-with-k8s/" target="_blank" rel="external">https://abelsu7.top/2018/09/19/manage-a-docker-cluster-with-k8s/</a>
        
    </div>
    
    <footer>
        <a href="https://abelsu7.top">
            <img src="/img/fong.jpg" alt="Abel Su">
            Abel Su
        </a>
    </footer>
</blockquote>

        
<div class="page-reward">
    <a id="rewardBtn" href="javascript:;" class="page-reward-btn waves-effect waves-circle waves-light">èµ</a>
</div>



        <div class="post-footer">
            
	<ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Docker/">Docker</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Kubernetes/">Kubernetes</a></li></ul>


            
<div class="page-share-wrap">
    

<div class="page-share" id="pageShare">
    <ul class="reset share-icons">
      <li>
        <a class="weibo share-sns" target="_blank" href="http://service.weibo.com/share/share.php?url=https://abelsu7.top/2018/09/19/manage-a-docker-cluster-with-k8s/&title=ã€Šã€è¯‘ã€‘ä½¿ç”¨ Kubernetes ç®¡ç† Docker é›†ç¾¤ã€‹ â€” Keep Coding&pic=https://abelsu7.top/img/fong.jpg" data-title="å¾®åš">
          <i class="icon icon-weibo"></i>
        </a>
      </li>
      <li>
        <a class="weixin share-sns wxFab" href="javascript:;" data-title="å¾®ä¿¡">
          <i class="icon icon-weixin"></i>
        </a>
      </li>
      <li>
        <a class="qq share-sns" target="_blank" href="http://connect.qq.com/widget/shareqq/index.html?url=https://abelsu7.top/2018/09/19/manage-a-docker-cluster-with-k8s/&title=ã€Šã€è¯‘ã€‘ä½¿ç”¨ Kubernetes ç®¡ç† Docker é›†ç¾¤ã€‹ â€” Keep Coding&source=
è¯‘è‡ª Manage a Docker Cluster with Kubernetes | Linode


                
     ..." data-title=" QQ">
          <i class="icon icon-qq"></i>
        </a>
      </li>
      <li>
        <a class="facebook share-sns" target="_blank" href="https://www.facebook.com/sharer/sharer.php?u=https://abelsu7.top/2018/09/19/manage-a-docker-cluster-with-k8s/" data-title=" Facebook">
          <i class="icon icon-facebook"></i>
        </a>
      </li>
      <li>
        <a class="twitter share-sns" target="_blank" href="https://twitter.com/intent/tweet?text=ã€Šã€è¯‘ã€‘ä½¿ç”¨ Kubernetes ç®¡ç† Docker é›†ç¾¤ã€‹ â€” Keep Coding&url=https://abelsu7.top/2018/09/19/manage-a-docker-cluster-with-k8s/&via=https://abelsu7.top" data-title=" Twitter">
          <i class="icon icon-twitter"></i>
        </a>
      </li>
      <li>
        <a class="google share-sns" target="_blank" href="https://plus.google.com/share?url=https://abelsu7.top/2018/09/19/manage-a-docker-cluster-with-k8s/" data-title=" Google+">
          <i class="icon icon-google-plus"></i>
        </a>
      </li>
    </ul>
 </div>



    <a href="javascript:;" id="shareFab" class="page-share-fab waves-effect waves-circle">
        <i class="icon icon-share-alt icon-lg"></i>
    </a>
</div>



        </div>
    </div>

    
<nav class="post-nav flex-row flex-justify-between">
  
    <div class="waves-block waves-effect prev">
      <a href="/2018/09/19/js-get-dom-height-and-width/" id="post-prev" class="post-nav-link">
        <div class="tips"><i class="icon icon-angle-left icon-lg icon-pr"></i> Prev</div>
        <h4 class="title">JavaScriptè·å–ç½‘é¡µæ»šåŠ¨è·ç¦»åŠDOMå…ƒç´ å®½é«˜å±æ€§</h4>
      </a>
    </div>
  

  
    <div class="waves-block waves-effect next">
      <a href="/2018/09/14/remote-desktop-using-apache-guacamole-on-docker/" id="post-next" class="post-nav-link">
        <div class="tips">Next <i class="icon icon-angle-right icon-lg icon-pl"></i></div>
        <h4 class="title">ã€è¯‘ã€‘ä½¿ç”¨ Apache Guacamole è¿æ¥è™šæ‹Ÿäº‘æ¡Œé¢</h4>
      </a>
    </div>
  
</nav>



    











    <!-- Valine Comments -->
    <div class="comments vcomment v" id="vcomments"></div>
    <!-- <div class="comment" id="comment"></div> -->
    <script src="//cdn1.lncld.net/static/js/3.0.4/av-min.js"></script>
    <script src="//cdn.jsdelivr.net/npm/valine/dist/Valine.min.js"></script>
    <!-- <script src="//t1.aixinxi.net/o_1c3n4pim01nl3jg91b6l1kjtkvsa.js"></script> -->
    <!-- <script src="/js/Valine.min.js"></script> -->
    <!-- <script src="https://cdnjs.cat.net/ajax/libs/jquery/3.2.1/jquery.min.js"></script> -->
    <script src="//cdn.jsdelivr.net/npm/jquery@3.3.1/dist/jquery.min.js"></script>
    <!-- Valine Comments script -->
    <script>
        var GUEST_INFO = ['nick','mail','link'];
        var guest_info = 'nick,mail,link'.split(',').filter(function(item){
          return GUEST_INFO.indexOf(item) > -1
        });
        new Valine({
            av: AV,
            // el: '#comments',
            el: '#vcomments',
            emoticon_url: 'https://abelsu7.top/alu', //è¡¨æƒ…å›¾ç‰‡ç½‘å€
            emoticon_list: ["èµä¸€ä¸ª.png","åç­‰.png","é•¿è‰.png","é˜´æš—.png","é‚ªæ¶.png","å°çœ¼ç›.png","æƒ³ä¸€æƒ³.png","çŒ®é»„ç“œ.png","çŒ®èŠ±.png","å–œæè€Œæ³£.png","æ— è¯­.png","æ— æ‰€è°“.png","æ— å¥ˆ.png","æŠ•é™.png","æ·±æ€.png","æœŸå¾….png","ç‹‚æ±—.png","èœ¡çƒ›.png","çœ‹ä¸è§.png","æƒŠå–œ.png","å‡»æŒ.png","æ¬¢å‘¼.png","å¾—æ„.png","ä¸å‡ºæ‰€æ–™.png","è§‚å¯Ÿ.png"],//è¡¨æƒ…å›¾ç‰‡æ–‡ä»¶å
            // notify: 'false' == 'false',
            // verify: 'false' == 'false',
            // notify: 'false',
            // verify: 'false',
            notify: false,
            verify: false,
            appId: "aP2YQo0mfrRpTLrLb1bchILb-gzGzoHsz",
            appKey: "Cp82umQdGScRRFUYLmob6yyK",
            avatar: "mp",
            placeholder: "Write a comment",
            guest_info: guest_info.length == 0 ? GUEST_INFO : guest_info,
            pageSize: "10"
        })
    </script>
    <!-- Valine Comments end -->











</article>

<div id="reward" class="page-modal reward-lay">
    <a class="close" href="javascript:;"><i class="icon icon-close"></i></a>
    <h3 class="reward-title">
        <i class="icon icon-quote-left"></i>
        æ„Ÿè°¢æ”¯æŒï¼
        <i class="icon icon-quote-right"></i>
    </h3>
    <div class="reward-content">
        
        <div class="reward-code">
            <img id="rewardCode" src="/img/wechat.png" alt="æ‰“èµäºŒç»´ç ">
        </div>
        
        <label class="reward-toggle">
            <input id="rewardToggle" type="checkbox" class="reward-toggle-check"
                data-wechat="/img/wechat.png" data-alipay="/img/alipay.jpg">
            <div class="reward-toggle-ctrol">
                <span class="reward-toggle-item wechat">å¾®ä¿¡</span>
                <span class="reward-toggle-item switch">åˆ‡æ¢</span>
                <span class="reward-toggle-item alipay">æ”¯ä»˜å®</span>
            </div>
        </label>
        
    </div>
</div>



</div>

        <footer class="footer">
    <div class="top">
        
<p>
    <span id="busuanzi_container_site_uv" style='display:none'>
        ç«™ç‚¹æ€»è®¿å®¢æ•°ï¼š<span id="busuanzi_value_site_uv"></span>
    </span>
    <span id="busuanzi_container_site_pv" style='display:none'>
        ç«™ç‚¹æ€»è®¿é—®é‡ï¼š<span id="busuanzi_value_site_pv"></span>
    </span>
</p>


            <p>
                
                    <span>
                        <a href="/atom.xml" target="_blank" class="rss" title="rss">
                            <i class="icon icon-lg icon-rss"></i>
                        </a>
                    </span>
                    
                        <span>
                            åšå®¢å†…å®¹éµå¾ª <a rel="license" href="https://creativecommons.org/licenses/by-nc-sa/4.0/deed.zh">çŸ¥è¯†å…±äº« ç½²å - éå•†ä¸šæ€§ - ç›¸åŒæ–¹å¼å…±äº« 4.0 å›½é™…åè®®</a>
                        </span>
            </p>
    </div>
    <div class="bottom">
        <p>
            <span>
                Abel Su &copy;
                    
                        2018 -
                            
                                2020
            </span>
            <span>
                
                    <a href="http://beian.miit.gov.cn/" target="_blank">
                        ç²¤ICPå¤‡16068788å·-2
                    </a>
                    <br>
                    
                        Power by
                        <a href="http://hexo.io/" target="_blank">Hexo</a> Theme
                        <a href="https://github.com/abelsu7/hexo-theme-indigo-plus" target="_blank">indigo plus</a>
                        <p>Hosted by <a href="https://cloud.tencent.com/product/cos" target="_blank" style="font-weight: bold">è…¾è®¯äº‘ COS</a></p>
            </span>
        </p>
    </div>
</footer>

    </main>
    <div class="mask" id="mask"></div>
<a href="javascript:;" id="gotop" class="waves-effect waves-circle waves-light"><span class="icon icon-lg icon-chevron-up"></span></a>
<a href="javascript:;" id="gobottom" class="waves-effect waves-circle waves-light"><span class="icon icon-lg icon-comments"></span></a>



<div class="global-share" id="globalShare">
    <ul class="reset share-icons">
      <li>
        <a class="weibo share-sns" target="_blank" href="http://service.weibo.com/share/share.php?url=https://abelsu7.top/2018/09/19/manage-a-docker-cluster-with-k8s/&title=ã€Šã€è¯‘ã€‘ä½¿ç”¨ Kubernetes ç®¡ç† Docker é›†ç¾¤ã€‹ â€” Keep Coding&pic=https://abelsu7.top/img/fong.jpg" data-title="å¾®åš">
          <i class="icon icon-weibo"></i>
        </a>
      </li>
      <li>
        <a class="weixin share-sns wxFab" href="javascript:;" data-title="å¾®ä¿¡">
          <i class="icon icon-weixin"></i>
        </a>
      </li>
      <li>
        <a class="qq share-sns" target="_blank" href="http://connect.qq.com/widget/shareqq/index.html?url=https://abelsu7.top/2018/09/19/manage-a-docker-cluster-with-k8s/&title=ã€Šã€è¯‘ã€‘ä½¿ç”¨ Kubernetes ç®¡ç† Docker é›†ç¾¤ã€‹ â€” Keep Coding&source=
è¯‘è‡ª Manage a Docker Cluster with Kubernetes | Linode


                
     ..." data-title=" QQ">
          <i class="icon icon-qq"></i>
        </a>
      </li>
      <li>
        <a class="facebook share-sns" target="_blank" href="https://www.facebook.com/sharer/sharer.php?u=https://abelsu7.top/2018/09/19/manage-a-docker-cluster-with-k8s/" data-title=" Facebook">
          <i class="icon icon-facebook"></i>
        </a>
      </li>
      <li>
        <a class="twitter share-sns" target="_blank" href="https://twitter.com/intent/tweet?text=ã€Šã€è¯‘ã€‘ä½¿ç”¨ Kubernetes ç®¡ç† Docker é›†ç¾¤ã€‹ â€” Keep Coding&url=https://abelsu7.top/2018/09/19/manage-a-docker-cluster-with-k8s/&via=https://abelsu7.top" data-title=" Twitter">
          <i class="icon icon-twitter"></i>
        </a>
      </li>
      <li>
        <a class="google share-sns" target="_blank" href="https://plus.google.com/share?url=https://abelsu7.top/2018/09/19/manage-a-docker-cluster-with-k8s/" data-title=" Google+">
          <i class="icon icon-google-plus"></i>
        </a>
      </li>
    </ul>
 </div>


<div class="page-modal wx-share" id="wxShare">
    <a class="close" href="javascript:;"><i class="icon icon-close"></i></a>
    <p>æ‰«ä¸€æ‰«ï¼Œåˆ†äº«åˆ°å¾®ä¿¡</p>
    <img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAN4AAADeCAAAAAB3DOFrAAACsklEQVR42u3awW4jIRAEUP//TzvSXhOzVTQ4jvQ4RfF4hjcHwNX9eMTj+W88yvH8Ntb3/H7l+g7HBh4eHt54Eu1j1tfnr2l95/V8Xr4CPDw8vGu89cMS6t7ynSz9r54VbWB4eHh4v8pLAMmn6xeXbwx4eHh4f4XXxgfr++THdzw8PLxP4yXTyv9Oto1nPNrv4uHh4d3mtQWwT/j7Yn0PDw8Pb1BVz5fpPGhoC1qT2eLh4eHd4LVxbR4ltMt6CysKY3h4eHjXeG0DQdteMNk22oM+Hh4e3j3e5Ljc4vPt4VhLAR4eHt5beMWP/HJjmKes+fH6QNaCh4eHFzxx/SN/Uqba234mwW7Rs4CHh4dX8pJINI8G2uN4e6ROXjceHh7eO3mnjsJ73VAtLwHj4eHh3ea1ZftJoSs/FiczrHsi8PDw8Aa89uCbdCIkdzhVbMtjDjw8PLyzvJyUF7oOH44HPwDw8PDwbvBOHXyTT9tXtkfFw8PDu8drw4hJc9Xe9e3G8ENPGR4eHt5beHkbwd5/9sKFugkMDw8P7wIv2QDmsUJ+CG5D5KJ9AQ8PD+8or41l520He8HxXviLh4eHd5aXRwN7x+h5IW3UsoCHh4d3gZcs05M4ID9wTzaGUWcEHh4eXsnbO0zvFcby7Sd5BdH2g4eHh3eBl395b2meH8TbgBgPDw/vNq8NGvJP581VRQ796lt4eHh4F3htzJqXvib32dvH/nMlHh4e3iHesxz5tyYBRxLmRsUzPDw8vAu8fJwt5+cTmmwqeHh4ePd48yV+bxFvJ9rOAQ8PD+82Ly+A5UFt23DQtmdFpTg8PDy8D+Dlj2mnklDrJgY8PDy8X+VNQoE8vJi8gqhpAA8PD+8QLw8j5rAkbjgVVeDh4eHd4LUFsFPR7V4MkeBH9T08PDy81T2/AM+8xptUzg7yAAAAAElFTkSuQmCC" alt="å¾®ä¿¡åˆ†äº«äºŒç»´ç ">
</div>




    <script src="//cdn.jsdelivr.net/npm/node-waves@0.7.6/src/js/waves.min.js"></script>
<script>
var BLOG = { ROOT: '/', SHARE: true, REWARD: true };


</script>

<script src="/js/main.min.js?v=1.7.2"></script>


<div class="search-panel" id="search-panel">
    <ul class="search-result" id="search-result"></ul>
</div>
<template id="search-tpl">
<li class="item">
    <a href="{path}" class="waves-block waves-effect">
        <div class="title ellipsis" title="{title}">{title}</div>
        <div class="flex-row flex-middle">
            <div class="tags ellipsis">
                {tags}
            </div>
            <time class="flex-col time">{date}</time>
        </div>
    </a>
</li>
</template>

<script src="/js/search.min.js?v=1.7.2" async></script>






<script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>




<script src="/js/prism.min.js?v=1.7.2"></script>
<script src="/js/prism-vim.min.js?v=1.7.2"></script>
</body>
</html>
